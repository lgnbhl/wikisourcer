<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to wikisourcer • wikisourcer</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to wikisourcer">
<meta property="og:description" content="wikisourcer">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-158089797-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-158089797-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">wikisourcer</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../articles/wikisourcer.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://www.linkedin.com/in/felixluginbuhl">
    <span class="fa fa-linkedin"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/felixluginbuhl">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/lgnbhl/wikisourcer">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="http://felixluginbuhl.com">
    <span class="fa fa-home"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="wikisourcer_files/header-attrs-2.2/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to wikisourcer</h1>
                        <h4 class="author">Félix Luginbühl</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/lgnbhl/wikisourcer/blob/master/vignettes/wikisourcer.Rmd"><code>vignettes/wikisourcer.Rmd</code></a></small>
      <div class="hidden name"><code>wikisourcer.Rmd</code></div>

    </div>

    
    
<p>The digital library <a href="https://wikisource.org/">Wikisource</a>, a sister project of <em>Wikipedia</em>, hosts books in the public domain in almost all languages. More than 100’000 books are accessible in English, Spanish, French, German, Russian or Chinese.</p>
<p>The <strong>wikisourcer</strong> R package helps you download any book or page from Wikisource. The text is downloaded in a tidy dataframe, so it can be analyzed within the tidyverse ecosystem as explained for example in the book <em><a href="https://www.tidytextmining.com">Text mining with R</a></em>.</p>
<div id="download-books" class="section level2">
<h2 class="hasAnchor">
<a href="#download-books" class="anchor"></a>Download books</h2>
<p>To download Voltaire’s philosophical novel <em>Candide</em>, simply paste the url of the table of content into the <code>wikisource_book</code> function. Note that the book is already classified by chapter with the <code>page</code> variable.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">wikisourcer</span>)

<span class="fu"><a href="../reference/wikisource_book.html">wikisource_book</a></span>(<span class="kw">url</span> <span class="kw">=</span> <span class="st">"https://en.wikisource.org/wiki/Candide"</span>)</pre></body></html></div>
<pre><code>## # A tibble: 864 x 5
##    text                               page language url                    title
##    &lt;chr&gt;                             &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;                  &lt;chr&gt;
##  1 ""                                    1 en       https://en.wikisource… Cand…
##  2 "In the country of Westphalia, i…     1 en       https://en.wikisource… Cand…
##  3 "The Baron was one of the most p…     1 en       https://en.wikisource… Cand…
##  4 "My Lady Baroness, who weighed t…     1 en       https://en.wikisource… Cand…
##  5 "Master Pangloss taught the meta…     1 en       https://en.wikisource… Cand…
##  6 "\"It is demonstrable,\" said he…     1 en       https://en.wikisource… Cand…
##  7 "Candide listened attentively an…     1 en       https://en.wikisource… Cand…
##  8 "One day when Miss Cunegund went…     1 en       https://en.wikisource… Cand…
##  9 "On her way back she happened to…     1 en       https://en.wikisource… Cand…
## 10 ""                                    1 en       https://en.wikisource… Cand…
## # … with 854 more rows</code></pre>
<p>Multiple books can easily be downloaded using the <code>purrr</code> package. For example, we can download <em>Candide</em> in French, English, Spanish and Italian.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">purrr</span>)

<span class="no">fr</span> <span class="kw">&lt;-</span> <span class="st">"https://fr.wikisource.org/wiki/Candide,_ou_l%E2%80%99Optimisme/Garnier_1877"</span>
<span class="no">en</span> <span class="kw">&lt;-</span> <span class="st">"https://en.wikisource.org/wiki/Candide"</span>
<span class="no">es</span> <span class="kw">&lt;-</span> <span class="st">"https://es.wikisource.org/wiki/C%C3%A1ndido,_o_el_optimismo"</span>
<span class="no">it</span> <span class="kw">&lt;-</span> <span class="st">"https://it.wikisource.org/wiki/Candido"</span>
<span class="no">urls</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">fr</span>, <span class="no">en</span>, <span class="no">es</span>, <span class="no">it</span>)

<span class="no">candide</span> <span class="kw">&lt;-</span> <span class="kw pkg">purrr</span><span class="kw ns">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_df</a></span>(<span class="no">urls</span>, <span class="no">wikisource_book</span>)</pre></body></html></div>
<p>Before making a text analysis, the text should be cleaned from remaining Wikisource metadata.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">stringr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)

<span class="no">candide_cleaned</span> <span class="kw">&lt;-</span> <span class="no">candide</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(!<span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span>(<span class="no">text</span>, <span class="st">"CHAPITRE|↑"</span>)) <span class="kw">%&gt;%</span> <span class="co">#clean French</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(!<span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span>(<span class="no">text</span>, <span class="st">"CAPITULO"</span>)) <span class="kw">%&gt;%</span> <span class="co">#clean Spanish</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(!<span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span>(<span class="no">text</span>, <span class="st">"../|IncludiIntestazione|Romanzi|^\\d+"</span>)) <span class="co">#clean Italian</span></pre></body></html></div>
<p>We can now compare the number of words in each chapter by language.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">tidytext</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)

<span class="no">candide_cleaned</span> <span class="kw">%&gt;%</span>
  <span class="kw pkg">tidytext</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/tidytext/man/unnest_tokens.html">unnest_tokens</a></span>(<span class="no">word</span>, <span class="no">text</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span>(<span class="no">page</span>, <span class="no">language</span>, <span class="kw">sort</span> <span class="kw">=</span> <span class="fl">TRUE</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="no">page</span>), <span class="kw">y</span> <span class="kw">=</span> <span class="no">n</span>, <span class="kw">fill</span> <span class="kw">=</span> <span class="no">language</span>)) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span>(<span class="kw">position</span> <span class="kw">=</span> <span class="st">"dodge"</span>) +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span>() +
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="st">"chapter"</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="st">"number of words"</span>,
         <span class="kw">title</span> <span class="kw">=</span> <span class="st">"Multilingual Text analysis of Voltaire's Candide"</span>)</pre></body></html></div>
<p><img src="wikisourcer_files/figure-html/language_analysis-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div id="download-pages" class="section level2">
<h2 class="hasAnchor">
<a href="#download-pages" class="anchor"></a>Download pages</h2>
<p>The <code>wikisource_book</code> function sometimes doesn’t work. It happens when the main url path differs from the ones of the linked urls or when the function fails to identify correctly the linked urls. This issue can easily be fixed using the <code>wikisource_page</code> function.</p>
<p>The <code>wikisource_page</code> function has two arguments, i.e. the Wikisource url and an optional title for the page. For example, we can download <em>Sonnet 18</em> of William Shakespeare.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="../reference/wikisource_page.html">wikisource_page</a></span>(<span class="st">"https://en.wikisource.org/wiki/Shakespeare's_Sonnets_(1883)/Sonnet_18"</span>,
                <span class="kw">page</span> <span class="kw">=</span> <span class="st">"Sonnet 18"</span>) <span class="kw">%&gt;%</span>
  <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(!(<span class="no">text</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">""</span>,<span class="st">" "</span>))) <span class="co">#remove blank rows</span></pre></body></html></div>
<pre><code>## # A tibble: 14 x 4
##    text                             page   language url                         
##    &lt;chr&gt;                            &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;                       
##  1 ​                                 Sonne… en       https://en.wikisource.org/w…
##  2 XVIII.                           Sonne… en       https://en.wikisource.org/w…
##  3 Shall I compare thee to a summe… Sonne… en       https://en.wikisource.org/w…
##  4 Thou art more lovely and more t… Sonne… en       https://en.wikisource.org/w…
##  5 Rough winds do shake the darlin… Sonne… en       https://en.wikisource.org/w…
##  6 And summer's lease hath all too… Sonne… en       https://en.wikisource.org/w…
##  7 Sometime too hot the eye of hea… Sonne… en       https://en.wikisource.org/w…
##  8 And often is his gold complexio… Sonne… en       https://en.wikisource.org/w…
##  9 And every fair from fair someti… Sonne… en       https://en.wikisource.org/w…
## 10 By chance or nature's changing … Sonne… en       https://en.wikisource.org/w…
## 11 But thy eternal summer shall no… Sonne… en       https://en.wikisource.org/w…
## 12 Nor lose possession of that fai… Sonne… en       https://en.wikisource.org/w…
## 13 Nor shall Death brag thou wande… Sonne… en       https://en.wikisource.org/w…
## 14 When in eternal lines to time t… Sonne… en       https://en.wikisource.org/w…</code></pre>
<p>The <code>wikisource_book</code> function fails to download the 154 Sonnets from the main url “<a href="https://en.wikisource.org/wiki/Shakespeare's_Sonnets" class="uri">https://en.wikisource.org/wiki/Shakespeare's_Sonnets</a>”. We have to use <code>wikisource_page</code> to download them.</p>
<p>Let’s begin by creating a list of the 154 wikipages we want to download, using the R base function <code>paste0</code>.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">urls</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"https://en.wikisource.org/wiki/Shakespeare's_Sonnets_(1883)/Sonnet_"</span>, <span class="fl">1</span>:<span class="fl">154</span>)</pre></body></html></div>
<p>Now we can download all the Sonnets with <code>purrr</code>.</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">sonnets</span> <span class="kw">&lt;-</span> <span class="kw pkg">purrr</span><span class="kw ns">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html">map2_df</a></span>(<span class="no">urls</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"Sonnet "</span>, <span class="fl">1</span>:<span class="fl">154</span>), <span class="no">wikisource_page</span>)
<span class="no">sonnets</span></pre></body></html></div>
<pre><code>## # A tibble: 4,751 x 4
##    text                    page    language url                                 
##    &lt;chr&gt;                   &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt;                               
##  1 ""                      Sonnet… en       https://en.wikisource.org/wiki/Shak…
##  2 ""                      Sonnet… en       https://en.wikisource.org/wiki/Shak…
##  3 ""                      Sonnet… en       https://en.wikisource.org/wiki/Shak…
##  4 "​"                      Sonnet… en       https://en.wikisource.org/wiki/Shak…
##  5 ""                      Sonnet… en       https://en.wikisource.org/wiki/Shak…
##  6 "HEAD OF EROS (CUPID),… Sonnet… en       https://en.wikisource.org/wiki/Shak…
##  7 ""                      Sonnet… en       https://en.wikisource.org/wiki/Shak…
##  8 "SONNETS. "             Sonnet… en       https://en.wikisource.org/wiki/Shak…
##  9 "I."                    Sonnet… en       https://en.wikisource.org/wiki/Shak…
## 10 ""                      Sonnet… en       https://en.wikisource.org/wiki/Shak…
## # … with 4,741 more rows</code></pre>
<p>We can make a text similarity analysis. Which sonnets are the closest to each others in terms of words used?</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">widyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">SnowballC</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">igraph</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggraph</span>)

<span class="no">sonnets_similarity</span> <span class="kw">&lt;-</span> <span class="no">sonnets</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(!<span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span>(<span class="no">text</span>, <span class="st">"public domain|Public domain"</span>)) <span class="kw">%&gt;%</span> <span class="co">#clean text</span>
  <span class="kw pkg">tidytext</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/tidytext/man/unnest_tokens.html">unnest_tokens</a></span>(<span class="no">word</span>, <span class="no">text</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter-joins.html">anti_join</a></span>(<span class="kw pkg">tidytext</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/tidytext/man/get_stopwords.html">get_stopwords</a></span>(<span class="st">"en"</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter-joins.html">anti_join</a></span>(<span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">data_frame</a></span>(<span class="kw">word</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"thy"</span>, <span class="st">"thou"</span>, <span class="st">"thee"</span>))) <span class="kw">%&gt;%</span> <span class="co">#old English stopwords</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">wordStem</span> <span class="kw">=</span> <span class="kw pkg">SnowballC</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/SnowballC/man/wordStem.html">wordStem</a></span>(<span class="no">word</span>)) <span class="kw">%&gt;%</span> <span class="co">#Stemming</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span>(<span class="no">page</span>, <span class="no">wordStem</span>) <span class="kw">%&gt;%</span>
  <span class="kw pkg">widyr</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/widyr/man/pairwise_similarity.html">pairwise_similarity</a></span>(<span class="no">page</span>, <span class="no">wordStem</span>, <span class="no">n</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">similarity</span> <span class="kw">&gt;</span> <span class="fl">0.25</span>)

<span class="co"># themes by sonnet </span>
<span class="no">theme</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">data_frame</a></span>(<span class="kw">page</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="no">sonnets</span>$<span class="no">page</span>),
                    <span class="kw">theme</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"Procreation"</span>, <span class="kw">times</span> <span class="kw">=</span> <span class="fl">17</span>), <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"Fair Youth"</span>, <span class="kw">times</span> <span class="kw">=</span> <span class="fl">60</span>),
                              <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"Rival Poet"</span>, <span class="kw">times</span> <span class="kw">=</span> <span class="fl">9</span>), <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"Fair Youth"</span>, <span class="kw">times</span> <span class="kw">=</span> <span class="fl">12</span>),
                              <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"Irregular"</span>, <span class="kw">times</span> <span class="kw">=</span> <span class="fl">1</span>), <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"Fair Youth"</span>, <span class="kw">times</span> <span class="kw">=</span> <span class="fl">26</span>),
                              <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"Irregular"</span>, <span class="kw">times</span> <span class="kw">=</span> <span class="fl">1</span>), <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="st">"Dark Lady"</span>, <span class="kw">times</span> <span class="kw">=</span> <span class="fl">28</span>))) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">page</span> <span class="kw">%in%</span> <span class="no">sonnets_similarity</span>$<span class="no">item1</span> <span class="kw">|</span>
         <span class="no">page</span> <span class="kw">%in%</span> <span class="no">sonnets_similarity</span>$<span class="no">item2</span>)

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">1234</span>)

<span class="no">sonnets_similarity</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html">graph_from_data_frame</a></span>(<span class="kw">vertices</span> <span class="kw">=</span> <span class="no">theme</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html">ggraph</a></span>() +
  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_edge_link.html">geom_edge_link</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">edge_alpha</span> <span class="kw">=</span> <span class="no">similarity</span>)) +
  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_point.html">geom_node_point</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">color</span> <span class="kw">=</span> <span class="no">theme</span>), <span class="kw">size</span> <span class="kw">=</span> <span class="fl">3</span>) +
  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_text.html">geom_node_text</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">label</span> <span class="kw">=</span> <span class="no">name</span>), <span class="kw">size</span> <span class="kw">=</span> <span class="fl">3.5</span>, <span class="kw">check_overlap</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">vjust</span> <span class="kw">=</span> <span class="fl">1</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span>() +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">title</span> <span class="kw">=</span> <span class="st">"Closest Shakespeare's Sonnets to each others in terms of words used"</span>)</pre></body></html></div>
<p><img src="wikisourcer_files/figure-html/similarity_analysis-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div id="tidy-text-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#tidy-text-analysis" class="anchor"></a>Tidy text analysis</h2>
<p>The <strong>wikisourcer</strong> package has been built to work within the tidyverse ecosystem. For example, we can easily make a <a href="https://www.tidytextmining.com/sentiment.html">tidy sentiment analysis</a> of any book by chapter, as the chapters are automatically created in the <code>page</code> variable.</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">tidyr</span>)

<span class="no">jane</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/wikisource_book.html">wikisource_book</a></span>(<span class="st">"https://en.wikisource.org/wiki/Pride_and_Prejudice"</span>)

<span class="no">jane_sent</span> <span class="kw">&lt;-</span> <span class="no">jane</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/tidytext/man/unnest_tokens.html">unnest_tokens</a></span>(<span class="no">word</span>, <span class="no">text</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/tidytext/man/get_sentiments.html">get_sentiments</a></span>(<span class="st">"bing"</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter-joins.html">anti_join</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/tidytext/man/get_stopwords.html">get_stopwords</a></span>(<span class="st">"en"</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span>(<span class="no">page</span>, <span class="no">sentiment</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/spread.html">spread</a></span>(<span class="kw">key</span> <span class="kw">=</span> <span class="no">sentiment</span>, <span class="kw">value</span> <span class="kw">=</span> <span class="no">n</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">sentiment</span> <span class="kw">=</span> <span class="no">positive</span> - <span class="no">negative</span>)

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">jane_sent</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="no">page</span>, <span class="no">sentiment</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span>() +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span>(<span class="kw">method</span> <span class="kw">=</span> <span class="st">"loess"</span>, <span class="kw">se</span> <span class="kw">=</span> <span class="fl">FALSE</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span>() +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">title</span> <span class="kw">=</span> <span class="st">"Sentiment analysis of “Pride and Prejudice”"</span>,
       <span class="kw">subtitle</span> <span class="kw">=</span> <span class="st">"Positive-negative words difference, by chapter"</span>,
       <span class="kw">x</span> <span class="kw">=</span> <span class="st">"chapter"</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="st">"sentiment score"</span>)</pre></body></html></div>
<p><img src="wikisourcer_files/figure-html/sentiment_analysis-1.png" width="672" style="display: block; margin: auto;"></p>
<p>More example of text analysis can be found in the book <em><a href="https://www.tidytextmining.com">Text mining with R</a></em>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Félix Luginbuhl.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
